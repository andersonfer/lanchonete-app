# BACKLOG - TECH CHALLENGE FASE 2 - ITEM 1

## ENTREG√ÅVEIS DO ITEM 1 (Checklist de Progresso)

### a. Alterar/criar as APIs:

#### i. Checkout Pedido
- [x] API que recebe produtos solicitados
- [x] Retorna identifica√ß√£o do pedido (ID)
- [x] Integra com fluxo de pagamento (statusPagamento: PENDENTE)

#### ii. Consultar status de pagamento pedido
- [x] API que informa se pagamento foi aprovado ou n√£o
- [x] Busca por ID do pedido

#### iii. Webhook para receber confirma√ß√£o de pagamento
- [x] Endpoint para receber notifica√ß√µes externas
- [x] Processa pagamento aprovado ou recusado
- [x] Implementa√ß√£o clara quanto ao Webhook

#### iv. Lista de pedidos com ordena√ß√£o espec√≠fica
- [x] Retorna pedidos com suas descri√ß√µes
- [x] Ordena√ß√£o: Pronto > Em Prepara√ß√£o > Recebido
- [x] Pedidos mais antigos primeiro, mais novos depois
- [x] Pedidos com status Finalizado N√ÉO aparecem na lista

#### v. Atualizar status do pedido
- [x] API para atualiza√ß√£o de status
- [x] Fluxo completo do pedido implementado
- [x] Informa√ß√£o utilizada pela cozinha
- [x] Garantia que nenhum pedido seja perdido
- [x] Cozinha pode iniciar prepara√ß√£o ap√≥s pagamento

#### vi. Integra√ß√£o com Mercado Pago (OPCIONAL - MOCK)
- [x] Mock da parte de pagamentos implementado
- [x] Simula√ß√£o de QRCode para pagamento
- [x] Integra√ß√£o com WebHook para capturar pagamentos

---

## BACKLOG DE TAREFAS

### üî¥ PRIORIDADE ALTA - FUNDA√á√ÉO ‚úÖ CONCLU√çDA

**1. Criar enum StatusPagamento no dom√≠nio**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Implementar enum StatusPagamento no pacote dominio/modelo
   - Inclui: Estados PENDENTE, APROVADO, REJEITADO

**2. Atualizar entidade Pedido para incluir StatusPagamento**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Adicionar campo StatusPagamento na entidade Pedido
   - Inclui: M√©todos para manipular status de pagamento

**3. Ajustar PedidoGatewayJDBC para persistir StatusPagamento**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Atualizar queries para incluir campo status_pagamento
   - Inclui: Mapeamento de enum StatusPagamento

**4. Criar estrutura do projeto mock-mercado-pago**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Novo projeto Spring Boot separado
   - Inclui: Estrutura b√°sica, application.yml, Dockerfile

### üü° PRIORIDADE M√âDIA - APIs CORE ‚úÖ CONCLU√çDA

**5. Implementar APIs de checkout com retorno de pedidoId**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Atualizar endpoint de checkout
   - Inclui: Inicializa√ß√£o com StatusPagamento.PENDENTE

**6. Implementar API de consulta de status de pagamento**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Nova API GET /pedidos/{id}/pagamento/status
   - Inclui: DTO de resposta, valida√ß√µes

**7. Implementar webhook para receber confirma√ß√£o de pagamento**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Nova API POST /webhook/pagamento
   - Inclui: Atualiza√ß√£o de StatusPagamento (APROVADO/REJEITADO)

**8. Implementar mock do Mercado Pago com comportamento aleat√≥rio**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: APIs no projeto mock-mercado-pago
   - Inclui: Simula√ß√£o de processamento, chamada de webhook

**9. Atualizar API de listagem de pedidos com regras de ordena√ß√£o**
   - Status: [x] Conclu√≠do
   - Descri√ß√£o: Modificar ordena√ß√£o conforme requisitos
   - Inclui: Query SQL atualizada, exclus√£o de Finalizados

**10. Implementar APIs para atualiza√ß√£o de status do pedido (cozinha)**
    - Status: [x] Conclu√≠do
    - Descri√ß√£o: APIs para cozinha gerenciar status
    - Inclui: GET /pedidos/cozinha, PUT /pedidos/{id}/status

### üî¥ PRIORIDADE ALTA - CORRE√á√ÉO CR√çTICA ‚úÖ CONCLU√çDA

**11. Corrigir webhook autom√°tico do servi√ßo de pagamento**
    - Status: [x] Conclu√≠do
    - Descri√ß√£o: Webhook autom√°tico retorna erro 400 Bad Request
    - Causa: WebClient n√£o enviando Content-Type: application/json
    - Solu√ß√£o: Adicionar header expl√≠cito no WebhookService.java linha 22
    - C√≥digo: `.header("Content-Type", "application/json")`
    - Impacto: Webhook manual funciona, mas autom√°tico falha
    - Severidade: ALTA - Funcionalidade principal comprometida
    - Valida√ß√£o: Testado com sucesso em Docker Compose

### üü¢ PRIORIDADE BAIXA - INFRAESTRUTURA E FINALIZA√á√ÉO ‚úÖ CONCLU√çDA

**12. Configurar Docker Compose para ambos os projetos**
    - Status: [x] Conclu√≠do
    - Descri√ß√£o: docker-compose.yml na raiz
    - Inclui: Networks, vari√°veis de ambiente

**13. Criar testes integrados para fluxo completo de pagamento**
    - Status: [x] Conclu√≠do
    - Descri√ß√£o: Testes E2E do fluxo checkout ‚Üí webhook ‚Üí status
    - Inclui: Testes de aprova√ß√£o e rejei√ß√£o

**14. Atualizar documenta√ß√£o e collection de APIs**
    - Status: [x] Conclu√≠do
    - Descri√ß√£o: README.md, Swagger, collection Postman
    - Inclui: Instru√ß√µes Docker, exemplos de uso
    - Detalhes: README totalmente reescrito com foco em Docker Compose e curl

---

## PROGRESSO ATUAL (16/07/2025)

### ‚úÖ CONCLU√çDO:
- **Funda√ß√£o StatusPagamento**: enum, entidade, persist√™ncia ‚úÖ
- **API Checkout**: integra√ß√£o com statusPagamento ‚úÖ
- **API Consulta Status**: endpoint GET /pedidos/{id}/pagamento/status ‚úÖ
- **Webhook de Pagamento**: endpoint POST /webhook/pagamento ‚úÖ
- **Mock Mercado Pago**: projeto pagamento implementado ‚úÖ
- **Docker Compose**: orquestra√ß√£o completa dos servi√ßos ‚úÖ
- **Testes**: 36+ testes passando (unit√°rios + integra√ß√£o + E2E) ‚úÖ
- **Testes de Integra√ß√£o**: fluxo completo validado ‚úÖ
- **Valida√ß√£o Manual**: webhook testado em aplica√ß√£o real ‚úÖ
- **Corre√ß√£o Webhook Autom√°tico**: erro 400 Bad Request corrigido ‚úÖ
- **Documenta√ß√£o Completa**: README totalmente reescrito com Docker Compose ‚úÖ

### üîÑ EM ANDAMENTO:
- Nenhuma tarefa em andamento

### ‚ö†Ô∏è PENDENTE:
- **ITEM 1 DO TECH CHALLENGE**: 100% CONCLU√çDO ‚úÖ
- **TODAS AS FUNCIONALIDADES**: Implementadas e testadas ‚úÖ

### üéØ PR√ìXIMOS PASSOS RECOMENDADOS:

**FASE 2 - ITEM 1**: ‚úÖ **COMPLETAMENTE FINALIZADO**

**Pr√≥ximas fases do Tech Challenge:**
1. **ITEM 2** - Melhorias de arquitetura e infraestrutura
2. **ITEM 3** - Implementa√ß√µes avan√ßadas

---

## ESTIMATIVA DE EXECU√á√ÉO (FINAL)
- ‚úÖ Funda√ß√£o (1-3): ~2-3 dias - **CONCLU√çDO**
- ‚úÖ APIs Core (5-7): ~2-3 dias - **CONCLU√çDO**
- ‚úÖ Complementares (8-10): ~2-3 dias - **CONCLU√çDO**
- ‚úÖ Finaliza√ß√£o (11-14): ~1-2 dias - **CONCLU√çDO**
- **Total real**: 8 dias de desenvolvimento (**100% conclu√≠do**)
- **Status**: TECH CHALLENGE FASE 2 - ITEM 1 FINALIZADO COM SUCESSO

---

## ANOTA√á√ïES
- Usar StatusPedido e StatusPagamento separados ‚úÖ
- StatusPagamento como enum dentro da entidade Pedido ‚úÖ
- Mock com 80% aprova√ß√£o, 20% rejei√ß√£o aleat√≥ria
- Docker Compose gerencia ambos os projetos

---

Data de cria√ß√£o: 16/06/2025
√öltima atualiza√ß√£o: 16/07/2025
Status: TECH CHALLENGE FASE 2 - ITEM 1 COMPLETAMENTE FINALIZADO ‚úÖ